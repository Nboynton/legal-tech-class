(window.webpackJsonp=window.webpackJsonp||[]).push([[72],{172:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return c})),n.d(t,"rightToc",(function(){return l})),n.d(t,"default",(function(){return d}));var a=n(1),r=n(6),o=(n(0),n(184)),i=(n(186),{id:"working-with-docx",title:"Working with Docx files",sidebar_label:"Working with Docx"}),c={id:"classes/docacon-2020/working-with-docx",isDocsHomePage:!1,title:"Working with Docx files",description:"The big picture",source:"@site/docs/classes/docacon-2020/working-with-docx.md",permalink:"/legal-tech-class/docs/classes/docacon-2020/working-with-docx",editUrl:"https://github.com/suffolklitlab/legal-tech-class/edit/master/class/docs/classes/docacon-2020/working-with-docx.md",sidebar_label:"Working with Docx",sidebar:"someSidebar",previous:{title:"Hello, World",permalink:"/legal-tech-class/docs/classes/docacon-2020/hello-world"},next:{title:"editing-docusaurus",permalink:"/legal-tech-class/docs/appendices/editing-docusaurus"}},l=[{value:"The big picture",id:"the-big-picture",children:[]},{value:"Hello, Docx",id:"hello-docx",children:[{value:"What happened?",id:"what-happened",children:[]}]},{value:"Further reading",id:"further-reading",children:[]}],s={rightToc:l};function d(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(o.b)("wrapper",Object(a.a)({},s,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("h2",{id:"the-big-picture"},"The big picture"),Object(o.b)("p",null,"In our ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"classes/hello-world.md"}),"Hello, World")," exercise, we did everything in the\nplayground."),Object(o.b)("p",null,"When you work with a Docx file, we're adding something new: an editor that can\nopen and save files in Microsoft Word's native format, docx. You don't need\nMicrosoft Office. You can use ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://www.libreoffice.org/"}),"Libre Office")," or\nthe ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://www.microsoft.com/en-us/microsoft-365/free-office-online-for-the-web"}),"free version of Office\nOnline"),"."),Object(o.b)("p",null,"We still have our YAML file. The YAML file will contain the questions that the\nuser is asked. The Docx file will contain our formatted text. It can also\ninclude variables that will be filled in by the interview. We can include\ndisplay logic and use Python functions to format our text as well."),Object(o.b)("p",null,"In the Hello, World exercise, we used ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"/legal-tech-class/docs/markdown"}),"Markdown")," and\n",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"/legal-tech-class/docs/mako"}),"Mako")," to display variables and format our text. In a Docx file, we use\na very similar language called ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"/legal-tech-class/docs/jinja2"}),"Jinja2"),"."),Object(o.b)("h2",{id:"hello-docx"},"Hello, Docx"),Object(o.b)("p",null,"Let's take a look at perhaps the simplest interview that automates a Docx template."),Object(o.b)("p",null,"First, create a Word document that looks like this:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{}),"Hello, {{ user_name }}!\n")),Object(o.b)("p",null,"You can copy and paste the text above right into the Word file. Name the file\n",Object(o.b)("inlineCode",{parentName:"p"},"hello_world.docx"),". Upload it to your playground using the Folders | Templates\narea of the playground."),Object(o.b)("p",null,"Next, make a new interview in your Docassemble playground that looks like this:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-yaml"}),"---\nquestion: |\n  What is your name?\nfields:\n  - no label: user_name\n---\nmandatory: True\nquestion: |\n  Your document is ready\nattachment:\n  docx template file: hello_world.docx\n")),Object(o.b)("p",null,"Save and run the interview, and see what you get."),Object(o.b)("h3",{id:"what-happened"},"What happened?"),Object(o.b)("p",null,"Our interview has a question for one variable: ",Object(o.b)("inlineCode",{parentName:"p"},"user_name"),". Inside the docx\nfile, we put the variable name inside curly brackets, like this: ",Object(o.b)("inlineCode",{parentName:"p"},"{{ user_name }}"),".\nDocassemble replaced ",Object(o.b)("inlineCode",{parentName:"p"},"{{ user_name }}")," with the text we entered when we ran the interview."),Object(o.b)("p",null,"Notice that the ",Object(o.b)("inlineCode",{parentName:"p"},"{{ }}")," is pretty similar to what we did in the Hello, World exercise.\nThis syntax is called ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"/legal-tech-class/docs/jinja2"}),"Jinja2"),". The big difference is in a Docx we use two curly\nbraces; in our interview YAML, we use a dollar sign and single curly braces,\nlike this: ",Object(o.b)("inlineCode",{parentName:"p"},"${ user_name }"),"."),Object(o.b)("p",null,"This is the first time that we introduced the\n",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://docassemble.org/docs/documents.html#attachment"}),"attachment")," ",Object(o.b)("inlineCode",{parentName:"p"},"specifier"),".\nThis is the simplest way to add an attachment to a question. Sometimes, you may\nwant to assign the completed document itself to a variable and do more things with it.\nOr, you may want to display different templates depending on the selections the user\nmakes."),Object(o.b)("h4",{id:"questions"},"Questions"),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"How did the interview know to ask for the definition of ",Object(o.b)("inlineCode",{parentName:"li"},"user_name"),"?")),Object(o.b)("h2",{id:"further-reading"},"Further reading"),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"The ",Object(o.b)("a",Object(a.a)({parentName:"li"},{href:"https://docassemble.org/docs/documents.html#attachment"}),"attachment")," block"),Object(o.b)("li",{parentName:"ol"},Object(o.b)("a",Object(a.a)({parentName:"li"},{href:"https://docassemble.org/docs/documents.html#docx%20template%20file"}),"Docx Templates")),Object(o.b)("li",{parentName:"ol"},Object(o.b)("a",Object(a.a)({parentName:"li"},{href:"https://docassemble.org/docs/helloworld.html"}),"Docassemble tutorial")),Object(o.b)("li",{parentName:"ol"},Object(o.b)("a",Object(a.a)({parentName:"li"},{href:"https://jinja.palletsprojects.com/en/2.11.x/"}),"Jinja reference")," (this is\nsimilar but not the exact syntax used in Docasssemble)"),Object(o.b)("li",{parentName:"ol"},Object(o.b)("a",Object(a.a)({parentName:"li"},{href:"https://docxtpl.readthedocs.io/en/latest/#jinja2-like-syntax"}),"Docx-template Jinja reference"))))}d.isMDXComponent=!0},184:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return h}));var a=n(0),r=n.n(a);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=r.a.createContext({}),d=function(e){var t=r.a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):c({},t,{},e)),n},b=function(e){var t=d(e.components);return r.a.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},p=Object(a.forwardRef)((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),b=d(n),p=a,h=b["".concat(i,".").concat(p)]||b[p]||u[p]||o;return n?r.a.createElement(h,c({ref:t},s,{components:n})):r.a.createElement(h,c({ref:t},s))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=p;var c={};for(var l in t)hasOwnProperty.call(t,l)&&(c[l]=t[l]);c.originalType=e,c.mdxType="string"==typeof e?e:a,i[1]=c;for(var s=2;s<o;s++)i[s]=n[s];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},185:function(e,t,n){"use strict";var a=n(0),r=n(35);t.a=function(){return Object(a.useContext)(r.a)}},186:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(185),r=n(187);function o(e,{forcePrependBaseUrl:t=!1,absolute:n=!1}={}){const{siteConfig:{baseUrl:o="/",url:i}={}}=Object(a.a)();if(!e)return e;if(t)return o+e;if(!Object(r.a)(e))return e;const c=o+e.replace(/^\//,"");return n?i+c:c}},187:function(e,t,n){"use strict";function a(e){return!1===/^(https?:|\/\/|mailto:|tel:)/.test(e)}n.d(t,"a",(function(){return a}))}}]);